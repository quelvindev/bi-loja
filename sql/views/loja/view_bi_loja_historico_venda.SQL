
CREATE OR REPLACE VIEW  view_bi_loja_historico_venda AS 

SELECT 
    DATA.MES||'/'||DATA.ANO  DATA,
    DATA.MES,
    UPPER( TO_CHAR(TO_DATE(DATA.MES,'MM'), 'FMMONTH', 'NLS_DATE_LANGUAGE = PORTUGUESE'))NOME_MES,
    UPPER( SUBSTR(TO_CHAR(TO_DATE(DATA.MES,'MM'), 'FMMONTH', 'NLS_DATE_LANGUAGE = PORTUGUESE'), 0, 3))NOME_MES_ABREVIADO,
    DATA.ANO,
    ITENS.CODPROD,
    ITENS.CODFILIAL,
    DECODE(DATA.ANO,TO_CHAR(SYSDATE,'YYYY'),
        DECODE(DATA.MES,
                    01,ITENS.VLCOMPRAMES01,
                    02,ITENS.VLCOMPRAMES02,
                    03,ITENS.VLCOMPRAMES03,
                    04,ITENS.VLCOMPRAMES04,
                    05,ITENS.VLCOMPRAMES05,
                    06,ITENS.VLCOMPRAMES06,
                    07,ITENS.VLCOMPRAMES07,
                    08,ITENS.VLCOMPRAMES08,
                    09,ITENS.VLCOMPRAMES09,
                    10,ITENS.VLCOMPRAMES10,
                    11,ITENS.VLCOMPRAMES11,
                    12,ITENS.VLCOMPRAMES12),
                    TO_CHAR( ADD_MONTHS(SYSDATE,-12),'YYYY'),
                        DECODE(DATA.MES,
                            01,ITENS.VLCOMPRAMES01,
                            02,ITENS.VLCOMPRAMES02,
                            03,ITENS.VLCOMPRAMES03,
                            04,ITENS.VLCOMPRAMES04,
                            05,ITENS.VLCOMPRAMES05,
                            06,ITENS.VLCOMPRAMES06,
                            07,ITENS.VLCOMPRAMES07,
                            08,ITENS.VLCOMPRAMES08,
                            09,ITENS.VLCOMPRAMES09,
                            10,ITENS.VLCOMPRAMES10,
                            11,ITENS.VLCOMPRAMES11,
                            12,ITENS.VLCOMPRAMES12),
                         TO_CHAR( ADD_MONTHS(SYSDATE,-24),'YYYY'),
                                DECODE(DATA.MES,
                                    01,ITENS.VLCOMPRAMES01,
                                    02,ITENS.VLCOMPRAMES02,
                                    03,ITENS.VLCOMPRAMES03,
                                    04,ITENS.VLCOMPRAMES04,
                                    05,ITENS.VLCOMPRAMES05,
                                    06,ITENS.VLCOMPRAMES06,
                                    07,ITENS.VLCOMPRAMES07,
                                    08,ITENS.VLCOMPRAMES08,
                                    09,ITENS.VLCOMPRAMES09,
                                    10,ITENS.VLCOMPRAMES10,
                                    11,ITENS.VLCOMPRAMES11,
                                    12,ITENS.VLCOMPRAMES12))  VLCOMPRAMES,
                                    
    DECODE(DATA.ANO,TO_CHAR(SYSDATE,'YYYY'),
        DECODE(DATA.MES,
                    01,ITENS.QTCOMPRAMES01,
                    02,ITENS.QTCOMPRAMES02,
                    03,ITENS.QTCOMPRAMES03,
                    04,ITENS.QTCOMPRAMES04,
                    05,ITENS.QTCOMPRAMES05,
                    06,ITENS.QTCOMPRAMES06,
                    07,ITENS.QTCOMPRAMES07,
                    08,ITENS.QTCOMPRAMES08,
                    09,ITENS.QTCOMPRAMES09,
                    10,ITENS.QTCOMPRAMES10,
                    11,ITENS.QTCOMPRAMES11,
                    12,ITENS.QTCOMPRAMES12 ),
                     TO_CHAR( ADD_MONTHS(SYSDATE,-12),'YYYY'), 
                        DECODE(DATA.MES,
                        01,ITENS.QTCOMPRAMES01,
                        02,ITENS.QTCOMPRAMES02,
                        03,ITENS.QTCOMPRAMES03,
                        04,ITENS.QTCOMPRAMES04,
                        05,ITENS.QTCOMPRAMES05,
                        06,ITENS.QTCOMPRAMES06,
                        07,ITENS.QTCOMPRAMES07,
                        08,ITENS.QTCOMPRAMES08,
                        09,ITENS.QTCOMPRAMES09,
                        10,ITENS.QTCOMPRAMES10,
                        11,ITENS.QTCOMPRAMES11,
                        12,ITENS.QTCOMPRAMES12 ),
                    TO_CHAR( ADD_MONTHS(SYSDATE,-24),'YYYY'),
                            DECODE(DATA.MES,
                                01,ITENS.QTCOMPRAMES01,
                                02,ITENS.QTCOMPRAMES02,
                                03,ITENS.QTCOMPRAMES03,
                                04,ITENS.QTCOMPRAMES04,
                                05,ITENS.QTCOMPRAMES05,
                                06,ITENS.QTCOMPRAMES06,
                                07,ITENS.QTCOMPRAMES07,
                                08,ITENS.QTCOMPRAMES08,
                                09,ITENS.QTCOMPRAMES09,
                                10,ITENS.QTCOMPRAMES10,
                                11,ITENS.QTCOMPRAMES11,
                                12,ITENS.QTCOMPRAMES12 ) ) QTCOMPRAMES,
                                
   DECODE(DATA.ANO,TO_CHAR(SYSDATE,'YYYY'),
        DECODE(DATA.MES,
                    01,ITENS.VLESTOQUEMES01,
                    02,ITENS.VLESTOQUEMES02,
                    03,ITENS.VLESTOQUEMES03,
                    04,ITENS.VLESTOQUEMES04,
                    05,ITENS.VLESTOQUEMES05,
                    06,ITENS.VLESTOQUEMES06,
                    07,ITENS.VLESTOQUEMES07,
                    08,ITENS.VLESTOQUEMES08,
                    09,ITENS.VLESTOQUEMES09,
                    10,ITENS.VLESTOQUEMES10,
                    11,ITENS.VLESTOQUEMES11,
                    12,ITENS.VLESTOQUEMES12),
                    TO_CHAR( ADD_MONTHS(SYSDATE,-12),'YYYY'),
                      DECODE(DATA.MES,
                               01,ITENS.VLESTOQUEMES01,
                               02,ITENS.VLESTOQUEMES02,
                               03,ITENS.VLESTOQUEMES03,
                               04,ITENS.VLESTOQUEMES04,
                               05,ITENS.VLESTOQUEMES05,
                               06,ITENS.VLESTOQUEMES06,
                               07,ITENS.VLESTOQUEMES07,
                               08,ITENS.VLESTOQUEMES08,
                               09,ITENS.VLESTOQUEMES09,
                               10,ITENS.VLESTOQUEMES10,
                               11,ITENS.VLESTOQUEMES11,
                               12,ITENS.VLESTOQUEMES12),
                      TO_CHAR( ADD_MONTHS(SYSDATE,-24),'YYYY'),
                        DECODE(DATA.MES,
                               01,ITENS.VLESTOQUEMES01,
                               02,ITENS.VLESTOQUEMES02,
                               03,ITENS.VLESTOQUEMES03,
                               04,ITENS.VLESTOQUEMES04,
                               05,ITENS.VLESTOQUEMES05,
                               06,ITENS.VLESTOQUEMES06,
                               07,ITENS.VLESTOQUEMES07,
                               08,ITENS.VLESTOQUEMES08,
                               09,ITENS.VLESTOQUEMES09,
                               10,ITENS.VLESTOQUEMES10,
                               11,ITENS.VLESTOQUEMES11,
                               12,ITENS.VLESTOQUEMES12)) VLESTOQUEMES,
                               
    DECODE(DATA.ANO,TO_CHAR(SYSDATE,'YYYY'),
        DECODE(DATA.MES,
                    01,ITENS.QTESTGERMES01,
                    02,ITENS.QTESTGERMES02,
                    03,ITENS.QTESTGERMES03,
                    04,ITENS.QTESTGERMES04,
                    05,ITENS.QTESTGERMES05,
                    06,ITENS.QTESTGERMES06,
                    07,ITENS.QTESTGERMES07,
                    08,ITENS.QTESTGERMES08,
                    09,ITENS.QTESTGERMES09,
                    10,ITENS.QTESTGERMES10,
                    11,ITENS.QTESTGERMES11,
                    12,ITENS.QTESTGERMES12),
                     TO_CHAR( ADD_MONTHS(SYSDATE,-12),'YYYY'),
                            DECODE(DATA.MES,
                            01,ITENS.QTESTGERMES01,
                            02,ITENS.QTESTGERMES02,
                            03,ITENS.QTESTGERMES03,
                            04,ITENS.QTESTGERMES04,
                            05,ITENS.QTESTGERMES05,
                            06,ITENS.QTESTGERMES06,
                            07,ITENS.QTESTGERMES07,
                            08,ITENS.QTESTGERMES08,
                            09,ITENS.QTESTGERMES09,
                            10,ITENS.QTESTGERMES10,
                            11,ITENS.QTESTGERMES11,
                            12,ITENS.QTESTGERMES12),
                             TO_CHAR( ADD_MONTHS(SYSDATE,-24),'YYYY'),
                                  DECODE(DATA.MES,
                                    01,ITENS.QTESTGERMES01,
                                    02,ITENS.QTESTGERMES02,
                                    03,ITENS.QTESTGERMES03,
                                    04,ITENS.QTESTGERMES04,
                                    05,ITENS.QTESTGERMES05,
                                    06,ITENS.QTESTGERMES06,
                                    07,ITENS.QTESTGERMES07,
                                    08,ITENS.QTESTGERMES08,
                                    09,ITENS.QTESTGERMES09,
                                    10,ITENS.QTESTGERMES10,
                                    11,ITENS.QTESTGERMES11,
                                    12,ITENS.QTESTGERMES12) ) QTESTGERMES,
                                    
    DECODE(DATA.ANO,TO_CHAR(SYSDATE,'YYYY'),
        DECODE(DATA.MES,
                    01,ITENS.PVENDAMES01,
                    02,ITENS.PVENDAMES02,
                    03,ITENS.PVENDAMES03,
                    04,ITENS.PVENDAMES04,
                    05,ITENS.PVENDAMES05,
                    06,ITENS.PVENDAMES06,
                    07,ITENS.PVENDAMES07,
                    08,ITENS.PVENDAMES08,
                    09,ITENS.PVENDAMES09,
                    10,ITENS.PVENDAMES10,
                    11,ITENS.PVENDAMES11,
                    12,ITENS.PVENDAMES12),
                    TO_CHAR( ADD_MONTHS(SYSDATE,-12),'YYYY'),
                          DECODE(DATA.MES,
                                01,ITENS.PVENDAMES01,
                                02,ITENS.PVENDAMES02,
                                03,ITENS.PVENDAMES03,
                                04,ITENS.PVENDAMES04,
                                05,ITENS.PVENDAMES05,
                                06,ITENS.PVENDAMES06,
                                07,ITENS.PVENDAMES07,
                                08,ITENS.PVENDAMES08,
                                09,ITENS.PVENDAMES09,
                                10,ITENS.PVENDAMES10,
                                11,ITENS.PVENDAMES11,
                                12,ITENS.PVENDAMES12),
                                TO_CHAR( ADD_MONTHS(SYSDATE,-24),'YYYY'),
                                          DECODE(DATA.MES,
                                              01,ITENS.PVENDAMES01,
                                              02,ITENS.PVENDAMES02,
                                              03,ITENS.PVENDAMES03,
                                              04,ITENS.PVENDAMES04,
                                              05,ITENS.PVENDAMES05,
                                              06,ITENS.PVENDAMES06,
                                              07,ITENS.PVENDAMES07,
                                              08,ITENS.PVENDAMES08,
                                              09,ITENS.PVENDAMES09,
                                              10,ITENS.PVENDAMES10,
                                              11,ITENS.PVENDAMES11,
                                              12,ITENS.PVENDAMES12) ) PVENDAMES,
                                              
                                              
    DECODE(DATA.ANO,TO_CHAR(SYSDATE,'YYYY'),
        DECODE(DATA.MES,
                    01,ITENS.QTVENDAMES01,
                    02,ITENS.QTVENDAMES02,
                    03,ITENS.QTVENDAMES03,
                    04,ITENS.QTVENDAMES04,
                    05,ITENS.QTVENDAMES05,
                    06,ITENS.QTVENDAMES06,
                    07,ITENS.QTVENDAMES07,
                    08,ITENS.QTVENDAMES08,
                    09,ITENS.QTVENDAMES09,
                    10,ITENS.QTVENDAMES10,
                    11,ITENS.QTVENDAMES11,
                    12,ITENS.QTVENDAMES12), 
                    TO_CHAR( ADD_MONTHS(SYSDATE,-12),'YYYY'),
                       DECODE(DATA.MES,
                            01,ITENS.QTVENDAMES01,
                            02,ITENS.QTVENDAMES02,
                            03,ITENS.QTVENDAMES03,
                            04,ITENS.QTVENDAMES04,
                            05,ITENS.QTVENDAMES05,
                            06,ITENS.QTVENDAMES06,
                            07,ITENS.QTVENDAMES07,
                            08,ITENS.QTVENDAMES08,
                            09,ITENS.QTVENDAMES09,
                            10,ITENS.QTVENDAMES10,
                            11,ITENS.QTVENDAMES11,
                            12,ITENS.QTVENDAMES12), 
                            TO_CHAR( ADD_MONTHS(SYSDATE,-24),'YYYY'),
                                   DECODE(DATA.MES,
                                        01,ITENS.QTVENDAMES01,
                                        02,ITENS.QTVENDAMES02,
                                        03,ITENS.QTVENDAMES03,
                                        04,ITENS.QTVENDAMES04,
                                        05,ITENS.QTVENDAMES05,
                                        06,ITENS.QTVENDAMES06,
                                        07,ITENS.QTVENDAMES07,
                                        08,ITENS.QTVENDAMES08,
                                        09,ITENS.QTVENDAMES09,
                                        10,ITENS.QTVENDAMES10,
                                        11,ITENS.QTVENDAMES11,
                                        12,ITENS.QTVENDAMES12)) QTVENDAMES,
                    
    DECODE(DATA.ANO,TO_CHAR(SYSDATE,'YYYY'),
        DECODE(DATA.MES,
                    01,ITENS.VLVENDAMES01,
                    02,ITENS.VLVENDAMES02,
                    03,ITENS.VLVENDAMES03,
                    04,ITENS.VLVENDAMES04,
                    05,ITENS.VLVENDAMES05,
                    06,ITENS.VLVENDAMES06,
                    07,ITENS.VLVENDAMES07,
                    08,ITENS.VLVENDAMES08,
                    09,ITENS.VLVENDAMES09,
                    10,ITENS.VLVENDAMES10,
                    11,ITENS.VLVENDAMES11,
                    12,ITENS.VLVENDAMES12), 
                    TO_CHAR( ADD_MONTHS(SYSDATE,-12),'YYYY'),
                         DECODE(DATA.MES,
                            01,ITENS.VLVENDAMES01,
                            02,ITENS.VLVENDAMES02,
                            03,ITENS.VLVENDAMES03,
                            04,ITENS.VLVENDAMES04,
                            05,ITENS.VLVENDAMES05,
                            06,ITENS.VLVENDAMES06,
                            07,ITENS.VLVENDAMES07,
                            08,ITENS.VLVENDAMES08,
                            09,ITENS.VLVENDAMES09,
                            10,ITENS.VLVENDAMES10,
                            11,ITENS.VLVENDAMES11,
                            12,ITENS.VLVENDAMES12), 
                            TO_CHAR( ADD_MONTHS(SYSDATE,-24),'YYYY'),
                                 DECODE(DATA.MES,
                                    01,ITENS.VLVENDAMES01,
                                    02,ITENS.VLVENDAMES02,
                                    03,ITENS.VLVENDAMES03,
                                    04,ITENS.VLVENDAMES04,
                                    05,ITENS.VLVENDAMES05,
                                    06,ITENS.VLVENDAMES06,
                                    07,ITENS.VLVENDAMES07,
                                    08,ITENS.VLVENDAMES08,
                                    09,ITENS.VLVENDAMES09,
                                    10,ITENS.VLVENDAMES10,
                                    11,ITENS.VLVENDAMES11,
                                    12,ITENS.VLVENDAMES12) ) VLVENDAMES,
                    
    DECODE(DATA.ANO,TO_CHAR(SYSDATE,'YYYY'),
        DECODE(DATA.MES,
                    01,ITENS.QTDEVCLI01,
                    02,ITENS.QTDEVCLI02,
                    03,ITENS.QTDEVCLI03,
                    04,ITENS.QTDEVCLI04,
                    05,ITENS.QTDEVCLI05,
                    06,ITENS.QTDEVCLI06,
                    07,ITENS.QTDEVCLI07,
                    08,ITENS.QTDEVCLI08,
                    09,ITENS.QTDEVCLI09,
                    10,ITENS.QTDEVCLI10,
                    11,ITENS.QTDEVCLI11,
                    12,ITENS.QTDEVCLI12),
                     TO_CHAR( ADD_MONTHS(SYSDATE,-24),'YYYY'),
                          DECODE(DATA.MES,
                                01,ITENS.QTDEVCLI01,
                                02,ITENS.QTDEVCLI02,
                                03,ITENS.QTDEVCLI03,
                                04,ITENS.QTDEVCLI04,
                                05,ITENS.QTDEVCLI05,
                                06,ITENS.QTDEVCLI06,
                                07,ITENS.QTDEVCLI07,
                                08,ITENS.QTDEVCLI08,
                                09,ITENS.QTDEVCLI09,
                                10,ITENS.QTDEVCLI10,
                                11,ITENS.QTDEVCLI11,
                                12,ITENS.QTDEVCLI12) ) QTDEVCLI,
                    
    DECODE(DATA.ANO,TO_CHAR(SYSDATE,'YYYY'),
        DECODE(DATA.MES,
                    01,ITENS.VLDEVCLI01,
                    02,ITENS.VLDEVCLI02,
                    03,ITENS.VLDEVCLI03,
                    04,ITENS.VLDEVCLI04,
                    05,ITENS.VLDEVCLI05,
                    06,ITENS.VLDEVCLI06,
                    07,ITENS.VLDEVCLI07,
                    08,ITENS.VLDEVCLI08,
                    09,ITENS.VLDEVCLI09,
                    10,ITENS.VLDEVCLI10,
                    11,ITENS.VLDEVCLI11,
                    12,ITENS.VLDEVCLI12),
                    TO_CHAR( ADD_MONTHS(SYSDATE,-12),'YYYY'),
                          DECODE(DATA.MES,
                            01,ITENS.VLDEVCLI01,
                            02,ITENS.VLDEVCLI02,
                            03,ITENS.VLDEVCLI03,
                            04,ITENS.VLDEVCLI04,
                            05,ITENS.VLDEVCLI05,
                            06,ITENS.VLDEVCLI06,
                            07,ITENS.VLDEVCLI07,
                            08,ITENS.VLDEVCLI08,
                            09,ITENS.VLDEVCLI09,
                            10,ITENS.VLDEVCLI10,
                            11,ITENS.VLDEVCLI11,
                            12,ITENS.VLDEVCLI12),
                            TO_CHAR( ADD_MONTHS(SYSDATE,-24),'YYYY'),
                                  DECODE(DATA.MES,
                                    01,ITENS.VLDEVCLI01,
                                    02,ITENS.VLDEVCLI02,
                                    03,ITENS.VLDEVCLI03,
                                    04,ITENS.VLDEVCLI04,
                                    05,ITENS.VLDEVCLI05,
                                    06,ITENS.VLDEVCLI06,
                                    07,ITENS.VLDEVCLI07,
                                    08,ITENS.VLDEVCLI08,
                                    09,ITENS.VLDEVCLI09,
                                    10,ITENS.VLDEVCLI10,
                                    11,ITENS.VLDEVCLI11,
                                    12,ITENS.VLDEVCLI12)) VLDEVCLI,
                   
    DECODE(DATA.ANO,TO_CHAR(SYSDATE,'YYYY'),
        DECODE(DATA.MES,
                    01,ITENS.CUSTOFINMES01,
                    02,ITENS.CUSTOFINMES02,
                    03,ITENS.CUSTOFINMES03,
                    04,ITENS.CUSTOFINMES04,
                    05,ITENS.CUSTOFINMES05,
                    06,ITENS.CUSTOFINMES06,
                    07,ITENS.CUSTOFINMES07,
                    08,ITENS.CUSTOFINMES08,
                    09,ITENS.CUSTOFINMES09,
                    10,ITENS.CUSTOFINMES10,
                    11,ITENS.CUSTOFINMES11,
                    12,ITENS.CUSTOFINMES12),
                    TO_CHAR( ADD_MONTHS(SYSDATE,-12),'YYYY'),
                             DECODE(DATA.MES,
                                01,ITENS.CUSTOFINMES01,
                                02,ITENS.CUSTOFINMES02,
                                03,ITENS.CUSTOFINMES03,
                                04,ITENS.CUSTOFINMES04,
                                05,ITENS.CUSTOFINMES05,
                                06,ITENS.CUSTOFINMES06,
                                07,ITENS.CUSTOFINMES07,
                                08,ITENS.CUSTOFINMES08,
                                09,ITENS.CUSTOFINMES09,
                                10,ITENS.CUSTOFINMES10,
                                11,ITENS.CUSTOFINMES11,
                                12,ITENS.CUSTOFINMES12),
                                TO_CHAR( ADD_MONTHS(SYSDATE,-24),'YYYY'),
                                     DECODE(DATA.MES,
                                        01,ITENS.CUSTOFINMES01,
                                        02,ITENS.CUSTOFINMES02,
                                        03,ITENS.CUSTOFINMES03,
                                        04,ITENS.CUSTOFINMES04,
                                        05,ITENS.CUSTOFINMES05,
                                        06,ITENS.CUSTOFINMES06,
                                        07,ITENS.CUSTOFINMES07,
                                        08,ITENS.CUSTOFINMES08,
                                        09,ITENS.CUSTOFINMES09,
                                        10,ITENS.CUSTOFINMES10,
                                        11,ITENS.CUSTOFINMES11,
                                        12,ITENS.CUSTOFINMES12) ) CUSTOFINMES,
    
    DECODE(DATA.ANO,TO_CHAR(SYSDATE,'YYYY'),
        DECODE(DATA.MES,
                    01,ITENS.QTVENDALIQMES01,
                    02,ITENS.QTVENDALIQMES02,
                    03,ITENS.QTVENDALIQMES03,
                    04,ITENS.QTVENDALIQMES04,
                    05,ITENS.QTVENDALIQMES05,
                    06,ITENS.QTVENDALIQMES06,
                    07,ITENS.QTVENDALIQMES07,
                    08,ITENS.QTVENDALIQMES08,
                    09,ITENS.QTVENDALIQMES09,
                    10,ITENS.QTVENDALIQMES10,
                    11,ITENS.QTVENDALIQMES11,
                    12,ITENS.QTVENDALIQMES12),
                    TO_CHAR( ADD_MONTHS(SYSDATE,-12),'YYYY'),
                         DECODE(DATA.MES,
                            01,ITENS.QTVENDALIQMES01,
                            02,ITENS.QTVENDALIQMES02,
                            03,ITENS.QTVENDALIQMES03,
                            04,ITENS.QTVENDALIQMES04,
                            05,ITENS.QTVENDALIQMES05,
                            06,ITENS.QTVENDALIQMES06,
                            07,ITENS.QTVENDALIQMES07,
                            08,ITENS.QTVENDALIQMES08,
                            09,ITENS.QTVENDALIQMES09,
                            10,ITENS.QTVENDALIQMES10,
                            11,ITENS.QTVENDALIQMES11,
                            12,ITENS.QTVENDALIQMES12),
                            TO_CHAR( ADD_MONTHS(SYSDATE,-24),'YYYY'),
                                DECODE(DATA.MES,
                                    01,ITENS.QTVENDALIQMES01,
                                    02,ITENS.QTVENDALIQMES02,
                                    03,ITENS.QTVENDALIQMES03,
                                    04,ITENS.QTVENDALIQMES04,
                                    05,ITENS.QTVENDALIQMES05,
                                    06,ITENS.QTVENDALIQMES06,
                                    07,ITENS.QTVENDALIQMES07,
                                    08,ITENS.QTVENDALIQMES08,
                                    09,ITENS.QTVENDALIQMES09,
                                    10,ITENS.QTVENDALIQMES10,
                                    11,ITENS.QTVENDALIQMES11,
                                    12,ITENS.QTVENDALIQMES12)) QTVENDALIQMES,
                                    
    DECODE(DATA.ANO,TO_CHAR(SYSDATE,'YYYY'),
        DECODE(DATA.MES,
                    01,ITENS.VLVENDALIQMES01,
                    02,ITENS.VLVENDALIQMES02,
                    03,ITENS.VLVENDALIQMES03,
                    04,ITENS.VLVENDALIQMES04,
                    05,ITENS.VLVENDALIQMES05,
                    06,ITENS.VLVENDALIQMES06,
                    07,ITENS.VLVENDALIQMES07,
                    08,ITENS.VLVENDALIQMES08,
                    09,ITENS.VLVENDALIQMES09,
                    10,ITENS.VLVENDALIQMES10,
                    11,ITENS.VLVENDALIQMES11,
                    12,ITENS.VLVENDALIQMES12),
                    TO_CHAR( ADD_MONTHS(SYSDATE,-12),'YYYY'),
                        DECODE(DATA.MES,
                            01,ITENS.VLVENDALIQMES01,
                            02,ITENS.VLVENDALIQMES02,
                            03,ITENS.VLVENDALIQMES03,
                            04,ITENS.VLVENDALIQMES04,
                            05,ITENS.VLVENDALIQMES05,
                            06,ITENS.VLVENDALIQMES06,
                            07,ITENS.VLVENDALIQMES07,
                            08,ITENS.VLVENDALIQMES08,
                            09,ITENS.VLVENDALIQMES09,
                            10,ITENS.VLVENDALIQMES10,
                            11,ITENS.VLVENDALIQMES11,
                            12,ITENS.VLVENDALIQMES12),
                     TO_CHAR( ADD_MONTHS(SYSDATE,-24),'YYYY'),
                         DECODE(DATA.MES,
                           01,ITENS.VLVENDALIQMES01,
                           02,ITENS.VLVENDALIQMES02,
                           03,ITENS.VLVENDALIQMES03,
                           04,ITENS.VLVENDALIQMES04,
                           05,ITENS.VLVENDALIQMES05,
                           06,ITENS.VLVENDALIQMES06,
                           07,ITENS.VLVENDALIQMES07,
                           08,ITENS.VLVENDALIQMES08,
                           09,ITENS.VLVENDALIQMES09,
                           10,ITENS.VLVENDALIQMES10,
                           11,ITENS.VLVENDALIQMES11,
                           12,ITENS.VLVENDALIQMES12)) VLVENDALIQMES
   
FROM 

(SELECT 
    PCAUXPRO.ANO,
    PCAUXPRO.CODPROD,
    PCAUXPRO.CODFILIAL,
    /* VALOR COMPRA MES */
   SUM(NVL(PCAUXPRO.VLCOMPRAMES01,0))VLCOMPRAMES01,
   SUM(NVL(PCAUXPRO.VLCOMPRAMES02,0))VLCOMPRAMES02,
   SUM(NVL(PCAUXPRO.VLCOMPRAMES03,0))VLCOMPRAMES03,
   SUM(NVL(PCAUXPRO.VLCOMPRAMES04,0))VLCOMPRAMES04,
   SUM(NVL(PCAUXPRO.VLCOMPRAMES05,0))VLCOMPRAMES05,
   SUM(NVL(PCAUXPRO.VLCOMPRAMES06,0))VLCOMPRAMES06,
   SUM(NVL(PCAUXPRO.VLCOMPRAMES07,0))VLCOMPRAMES07,
   SUM(NVL(PCAUXPRO.VLCOMPRAMES08,0))VLCOMPRAMES08,
   SUM(NVL(PCAUXPRO.VLCOMPRAMES09,0))VLCOMPRAMES09,
   SUM(NVL(PCAUXPRO.VLCOMPRAMES10,0))VLCOMPRAMES10,
   SUM(NVL(PCAUXPRO.VLCOMPRAMES11,0))VLCOMPRAMES11,
   SUM(NVL(PCAUXPRO.VLCOMPRAMES12,0))VLCOMPRAMES12,
   /* QT COMPRA MES */
   SUM(NVL(PCAUXPRO.QTCOMPRAMES01,0))QTCOMPRAMES01,
   SUM(NVL(PCAUXPRO.QTCOMPRAMES02,0))QTCOMPRAMES02,
   SUM(NVL(PCAUXPRO.QTCOMPRAMES03,0))QTCOMPRAMES03,
   SUM(NVL(PCAUXPRO.QTCOMPRAMES04,0))QTCOMPRAMES04,
   SUM(NVL(PCAUXPRO.QTCOMPRAMES05,0))QTCOMPRAMES05,
   SUM(NVL(PCAUXPRO.QTCOMPRAMES06,0))QTCOMPRAMES06,
   SUM(NVL(PCAUXPRO.QTCOMPRAMES07,0))QTCOMPRAMES07,
   SUM(NVL(PCAUXPRO.QTCOMPRAMES08,0))QTCOMPRAMES08,
   SUM(NVL(PCAUXPRO.QTCOMPRAMES09,0))QTCOMPRAMES09,
   SUM(NVL(PCAUXPRO.QTCOMPRAMES10,0))QTCOMPRAMES10,
   SUM(NVL(PCAUXPRO.QTCOMPRAMES11,0))QTCOMPRAMES11,
   SUM(NVL(PCAUXPRO.QTCOMPRAMES12,0))QTCOMPRAMES12,
   /* VLR ESTOQUE MES */
   SUM(NVL(PCAUXPRO.VLESTOQUEMES01,0))VLESTOQUEMES01,
   SUM(NVL(PCAUXPRO.VLESTOQUEMES02,0))VLESTOQUEMES02,
   SUM(NVL(PCAUXPRO.VLESTOQUEMES03,0))VLESTOQUEMES03,
   SUM(NVL(PCAUXPRO.VLESTOQUEMES04,0))VLESTOQUEMES04,
   SUM(NVL(PCAUXPRO.VLESTOQUEMES05,0))VLESTOQUEMES05,
   SUM(NVL(PCAUXPRO.VLESTOQUEMES06,0))VLESTOQUEMES06,
   SUM(NVL(PCAUXPRO.VLESTOQUEMES07,0))VLESTOQUEMES07,
   SUM(NVL(PCAUXPRO.VLESTOQUEMES08,0))VLESTOQUEMES08,
   SUM(NVL(PCAUXPRO.VLESTOQUEMES09,0))VLESTOQUEMES09,
   SUM(NVL(PCAUXPRO.VLESTOQUEMES10,0))VLESTOQUEMES10,
   SUM(NVL(PCAUXPRO.VLESTOQUEMES11,0))VLESTOQUEMES11,
   SUM(NVL(PCAUXPRO.VLESTOQUEMES12,0))VLESTOQUEMES12,
   /* ESTOQUE MES */
   SUM(NVL(PCAUXPRO.QTESTGERMES01,0))QTESTGERMES01,
   SUM(NVL(PCAUXPRO.QTESTGERMES02,0))QTESTGERMES02,
   SUM(NVL(PCAUXPRO.QTESTGERMES03,0))QTESTGERMES03,
   SUM(NVL(PCAUXPRO.QTESTGERMES04,0))QTESTGERMES04,
   SUM(NVL(PCAUXPRO.QTESTGERMES05,0))QTESTGERMES05,
   SUM(NVL(PCAUXPRO.QTESTGERMES06,0))QTESTGERMES06,
   SUM(NVL(PCAUXPRO.QTESTGERMES07,0))QTESTGERMES07,
   SUM(NVL(PCAUXPRO.QTESTGERMES08,0))QTESTGERMES08,
   SUM(NVL(PCAUXPRO.QTESTGERMES09,0))QTESTGERMES09,
   SUM(NVL(PCAUXPRO.QTESTGERMES10,0))QTESTGERMES10,
   SUM(NVL(PCAUXPRO.QTESTGERMES11,0))QTESTGERMES11,
   SUM(NVL(PCAUXPRO.QTESTGERMES12,0))QTESTGERMES12,
   /* PRECO VENDA MES */
   NVL(PCAUXPRO.PVENDAMES01,0)PVENDAMES01,
   NVL(PCAUXPRO.PVENDAMES02,0)PVENDAMES02,
   NVL(PCAUXPRO.PVENDAMES03,0)PVENDAMES03,
   NVL(PCAUXPRO.PVENDAMES04,0)PVENDAMES04,
   NVL(PCAUXPRO.PVENDAMES05,0)PVENDAMES05,
   NVL(PCAUXPRO.PVENDAMES06,0)PVENDAMES06,
   NVL(PCAUXPRO.PVENDAMES07,0)PVENDAMES07,
   NVL(PCAUXPRO.PVENDAMES08,0)PVENDAMES08,
   NVL(PCAUXPRO.PVENDAMES09,0)PVENDAMES09,
   NVL(PCAUXPRO.PVENDAMES10,0)PVENDAMES10,
   NVL(PCAUXPRO.PVENDAMES11,0)PVENDAMES11,
   NVL(PCAUXPRO.PVENDAMES11,0)PVENDAMES12,
   /* QTD VENDA MES */
   SUM(NVL(PCAUXPRO.QTVENDAMES01,0))QTVENDAMES01,
   SUM(NVL(PCAUXPRO.QTVENDAMES02,0))QTVENDAMES02,
   SUM(NVL(PCAUXPRO.QTVENDAMES03,0))QTVENDAMES03,
   SUM(NVL(PCAUXPRO.QTVENDAMES04,0))QTVENDAMES04,
   SUM(NVL(PCAUXPRO.QTVENDAMES05,0))QTVENDAMES05,
   SUM(NVL(PCAUXPRO.QTVENDAMES06,0))QTVENDAMES06,
   SUM(NVL(PCAUXPRO.QTVENDAMES07,0))QTVENDAMES07,
   SUM(NVL(PCAUXPRO.QTVENDAMES08,0))QTVENDAMES08,
   SUM(NVL(PCAUXPRO.QTVENDAMES09,0))QTVENDAMES09,
   SUM(NVL(PCAUXPRO.QTVENDAMES10,0))QTVENDAMES10,
   SUM(NVL(PCAUXPRO.QTVENDAMES11,0))QTVENDAMES11,
   SUM(NVL(PCAUXPRO.QTVENDAMES12,0))QTVENDAMES12,
   /* VLR VENDA MES */
   SUM(NVL(PCAUXPRO.VLVENDAMES01,0))VLVENDAMES01,
   SUM(NVL(PCAUXPRO.VLVENDAMES02,0))VLVENDAMES02,
   SUM(NVL(PCAUXPRO.VLVENDAMES03,0))VLVENDAMES03,
   SUM(NVL(PCAUXPRO.VLVENDAMES04,0))VLVENDAMES04,
   SUM(NVL(PCAUXPRO.VLVENDAMES05,0))VLVENDAMES05,
   SUM(NVL(PCAUXPRO.VLVENDAMES06,0))VLVENDAMES06,
   SUM(NVL(PCAUXPRO.VLVENDAMES07,0))VLVENDAMES07,
   SUM(NVL(PCAUXPRO.VLVENDAMES08,0))VLVENDAMES08,
   SUM(NVL(PCAUXPRO.VLVENDAMES09,0))VLVENDAMES09,
   SUM(NVL(PCAUXPRO.VLVENDAMES10,0))VLVENDAMES10,
   SUM(NVL(PCAUXPRO.VLVENDAMES11,0))VLVENDAMES11,
   SUM(NVL(PCAUXPRO.VLVENDAMES12,0))VLVENDAMES12,
   /* QT DEVOLUCAO MES*/
   SUM(NVL(PCAUXPRO.QTDEVCLI01,0))QTDEVCLI01,
   SUM(NVL(PCAUXPRO.QTDEVCLI02,0))QTDEVCLI02,
   SUM(NVL(PCAUXPRO.QTDEVCLI03,0))QTDEVCLI03,
   SUM(NVL(PCAUXPRO.QTDEVCLI04,0))QTDEVCLI04,
   SUM(NVL(PCAUXPRO.QTDEVCLI05,0))QTDEVCLI05,
   SUM(NVL(PCAUXPRO.QTDEVCLI06,0))QTDEVCLI06,
   SUM(NVL(PCAUXPRO.QTDEVCLI07,0))QTDEVCLI07,
   SUM(NVL(PCAUXPRO.QTDEVCLI08,0))QTDEVCLI08,
   SUM(NVL(PCAUXPRO.QTDEVCLI09,0))QTDEVCLI09,
   SUM(NVL(PCAUXPRO.QTDEVCLI10,0))QTDEVCLI10,
   SUM(NVL(PCAUXPRO.QTDEVCLI11,0))QTDEVCLI11,
   SUM(NVL(PCAUXPRO.QTDEVCLI12,0))QTDEVCLI12,
   /* VLR DEVOLUCAO MES */
   SUM(NVL(PCAUXPRO.VLDEVCLI01,0))VLDEVCLI01,
   SUM(NVL(PCAUXPRO.VLDEVCLI02,0))VLDEVCLI02,
   SUM(NVL(PCAUXPRO.VLDEVCLI03,0))VLDEVCLI03,
   SUM(NVL(PCAUXPRO.VLDEVCLI04,0))VLDEVCLI04,
   SUM(NVL(PCAUXPRO.VLDEVCLI05,0))VLDEVCLI05,
   SUM(NVL(PCAUXPRO.VLDEVCLI06,0))VLDEVCLI06,
   SUM(NVL(PCAUXPRO.VLDEVCLI07,0))VLDEVCLI07,
   SUM(NVL(PCAUXPRO.VLDEVCLI08,0))VLDEVCLI08,
   SUM(NVL(PCAUXPRO.VLDEVCLI09,0))VLDEVCLI09,
   SUM(NVL(PCAUXPRO.VLDEVCLI10,0))VLDEVCLI10,
   SUM(NVL(PCAUXPRO.VLDEVCLI11,0))VLDEVCLI11,
   SUM(NVL(PCAUXPRO.VLDEVCLI12,0))VLDEVCLI12,
   /* CUSTO FINANCEIRO MES */
   NVL(PCAUXPRO.CUSTOFINMES01,0)CUSTOFINMES01,
   NVL(PCAUXPRO.CUSTOFINMES02,0)CUSTOFINMES02,
   NVL(PCAUXPRO.CUSTOFINMES03,0)CUSTOFINMES03,
   NVL(PCAUXPRO.CUSTOFINMES04,0)CUSTOFINMES04,
   NVL(PCAUXPRO.CUSTOFINMES05,0)CUSTOFINMES05,
   NVL(PCAUXPRO.CUSTOFINMES06,0)CUSTOFINMES06,
   NVL(PCAUXPRO.CUSTOFINMES07,0)CUSTOFINMES07,
   NVL(PCAUXPRO.CUSTOFINMES08,0)CUSTOFINMES08,
   NVL(PCAUXPRO.CUSTOFINMES09,0)CUSTOFINMES09,
   NVL(PCAUXPRO.CUSTOFINMES10,0)CUSTOFINMES10,
   NVL(PCAUXPRO.CUSTOFINMES11,0)CUSTOFINMES11,
   NVL(PCAUXPRO.CUSTOFINMES12,0)CUSTOFINMES12,
   /* QT VENDA LIQUIDA MES */
   SUM(NVL(PCAUXPRO.QTVENDAMES01,0) - NVL(PCAUXPRO.QTDEVCLI01,0))QTVENDALIQMES01,
   SUM(NVL(PCAUXPRO.QTVENDAMES02,0) - NVL(PCAUXPRO.QTDEVCLI02,0))QTVENDALIQMES02,
   SUM(NVL(PCAUXPRO.QTVENDAMES03,0) - NVL(PCAUXPRO.QTDEVCLI03,0))QTVENDALIQMES03,
   SUM(NVL(PCAUXPRO.QTVENDAMES04,0) - NVL(PCAUXPRO.QTDEVCLI04,0))QTVENDALIQMES04,
   SUM(NVL(PCAUXPRO.QTVENDAMES05,0) - NVL(PCAUXPRO.QTDEVCLI05,0))QTVENDALIQMES05,
   SUM(NVL(PCAUXPRO.QTVENDAMES06,0) - NVL(PCAUXPRO.QTDEVCLI06,0))QTVENDALIQMES06,
   SUM(NVL(PCAUXPRO.QTVENDAMES07,0) - NVL(PCAUXPRO.QTDEVCLI07,0))QTVENDALIQMES07,
   SUM(NVL(PCAUXPRO.QTVENDAMES08,0) - NVL(PCAUXPRO.QTDEVCLI08,0))QTVENDALIQMES08,
   SUM(NVL(PCAUXPRO.QTVENDAMES09,0) - NVL(PCAUXPRO.QTDEVCLI09,0))QTVENDALIQMES09,
   SUM(NVL(PCAUXPRO.QTVENDAMES10,0) - NVL(PCAUXPRO.QTDEVCLI10,0))QTVENDALIQMES10,
   SUM(NVL(PCAUXPRO.QTVENDAMES11,0) - NVL(PCAUXPRO.QTDEVCLI11,0))QTVENDALIQMES11,
   SUM(NVL(PCAUXPRO.QTVENDAMES12,0) - NVL(PCAUXPRO.QTDEVCLI12,0))QTVENDALIQMES12,
   
   /* VLR VENDA LIQUIDA MES */
    SUM(NVL(PCAUXPRO.VLVENDAMES01,0) - NVL(PCAUXPRO.VLDEVCLI01,0))VLVENDALIQMES01,
    SUM(NVL(PCAUXPRO.VLVENDAMES02,0) - NVL(PCAUXPRO.VLDEVCLI02,0))VLVENDALIQMES02,
    SUM(NVL(PCAUXPRO.VLVENDAMES03,0) - NVL(PCAUXPRO.VLDEVCLI03,0))VLVENDALIQMES03,
    SUM(NVL(PCAUXPRO.VLVENDAMES04,0) - NVL(PCAUXPRO.VLDEVCLI04,0))VLVENDALIQMES04,
    SUM(NVL(PCAUXPRO.VLVENDAMES05,0) - NVL(PCAUXPRO.VLDEVCLI05,0))VLVENDALIQMES05,
    SUM(NVL(PCAUXPRO.VLVENDAMES06,0) - NVL(PCAUXPRO.VLDEVCLI06,0))VLVENDALIQMES06,
    SUM(NVL(PCAUXPRO.VLVENDAMES07,0) - NVL(PCAUXPRO.VLDEVCLI07,0))VLVENDALIQMES07,
    SUM(NVL(PCAUXPRO.VLVENDAMES08,0) - NVL(PCAUXPRO.VLDEVCLI08,0))VLVENDALIQMES08,
    SUM(NVL(PCAUXPRO.VLVENDAMES09,0) - NVL(PCAUXPRO.VLDEVCLI09,0))VLVENDALIQMES09,
    SUM(NVL(PCAUXPRO.VLVENDAMES10,0) - NVL(PCAUXPRO.VLDEVCLI10,0))VLVENDALIQMES10,
    SUM(NVL(PCAUXPRO.VLVENDAMES11,0) - NVL(PCAUXPRO.VLDEVCLI11,0))VLVENDALIQMES11,
    SUM(NVL(PCAUXPRO.VLVENDAMES12,0) - NVL(PCAUXPRO.VLDEVCLI12,0))VLVENDALIQMES12
FROM PCAUXPRO
--WHERE  CODFILIAL IN(2) AND CODPROD = 951
GROUP BY 
    PCAUXPRO.ANO,
    PCAUXPRO.CODPROD,
    PCAUXPRO.CODFILIAL,
    PCAUXPRO.PVENDAMES01,
    PCAUXPRO.PVENDAMES02,
    PCAUXPRO.PVENDAMES03,
    PCAUXPRO.PVENDAMES04,
    PCAUXPRO.PVENDAMES05,
    PCAUXPRO.PVENDAMES06,
    PCAUXPRO.PVENDAMES07,
    PCAUXPRO.PVENDAMES08,
    PCAUXPRO.PVENDAMES09,
    PCAUXPRO.PVENDAMES10,
    PCAUXPRO.PVENDAMES11,
    PCAUXPRO.PVENDAMES11,
    PCAUXPRO.CUSTOFINMES01,
    PCAUXPRO.CUSTOFINMES02,
    PCAUXPRO.CUSTOFINMES03,
    PCAUXPRO.CUSTOFINMES04,
    PCAUXPRO.CUSTOFINMES05,
    PCAUXPRO.CUSTOFINMES06,
    PCAUXPRO.CUSTOFINMES07,
    PCAUXPRO.CUSTOFINMES08,
    PCAUXPRO.CUSTOFINMES09,
    PCAUXPRO.CUSTOFINMES10,
    PCAUXPRO.CUSTOFINMES11,
    PCAUXPRO.CUSTOFINMES12 )ITENS,
(SELECT 
    TO_CHAR(DATA,'YYYY')ANO,
    TO_CHAR(DATA,'MM')MES
    
FROM 
    PCDATAS 
WHERE 
    PCDATAS.DATA BETWEEN ADD_MONTHS(TRUNC(SYSDATE,'YY'),-24) AND TRUNC(SYSDATE)
GROUP BY
    TO_CHAR(DATA,'YYYY'),
    TO_CHAR(DATA,'MM'))DATA 
WHERE ITENS.ANO = DATA.ANO


ORDER BY 
ANO,
MES,
CODFILIAL

 WITH READ ONLY

